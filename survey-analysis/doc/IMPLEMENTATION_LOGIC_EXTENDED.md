# å®Ÿè£…ãƒ­ã‚¸ãƒƒã‚¯ã®èª¬æ˜ï¼ˆæ‹¡å¼µç‰ˆï¼‰

## ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
2. [ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ](#ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ)
3. [è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­è¨ˆ](#è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­è¨ˆ)
4. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
5. [ä¸»è¦ãªè¨­è¨ˆåˆ¤æ–­](#ä¸»è¦ãªè¨­è¨ˆåˆ¤æ–­)
6. [å®Ÿè£…ã®è©³ç´°](#å®Ÿè£…ã®è©³ç´°)
7. **[ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«](#ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«)** â† æ–°è¦è¿½åŠ 
8. **[ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«](#ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«)** â† æ–°è¦è¿½åŠ 

---

## ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆæ‹¡å¼µç‰ˆï¼‰

### å…¨ä½“æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      main.py                            â”‚
â”‚  - ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ                                     â”‚
â”‚  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³                                â”‚
â”‚  - ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼åˆ¶å¾¡                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                 â†“                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚data_generatorâ”‚  â”‚data_preprocessâ”‚ â”‚ data_analyser   â”‚
â”‚ - ã‚µãƒ³ãƒ—ãƒ«    â”‚  â”‚ - å‰å‡¦ç†      â”‚  â”‚ - åŸºæœ¬åˆ†æ       â”‚
â”‚   ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ  â”‚  â”‚ - ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰  â”‚  â”‚ - ç›¸é–¢åˆ†æ       â”‚
â”‚ - çµ±è¨ˆè¨ˆç®—   â”‚  â”‚ - æ¨™æº–åŒ–      â”‚  â”‚ - å±æ€§åˆ¥åˆ†æ     â”‚
â”‚             â”‚  â”‚ - ä»£è¡¨æ€§æ¤œè¨¼  â”‚  â”‚ - IPAåˆ†æ       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚report_generator â”‚
                 â”‚ - ç·åˆæº€è¶³åº¦    â”‚
                 â”‚ - ã‚°ãƒ©ãƒ•ç”Ÿæˆ    â”‚
                 â”‚ - ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      util.py                            â”‚
â”‚  - çµ±è¨ˆè¡¨ç¤º                                               â”‚
â”‚  - åˆ†æçµæœè¡¨ç¤º                                           â”‚
â”‚  - ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º                                           â”‚
â”‚  - å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  config.yaml    â”‚              â”‚ survey_questions.   â”‚
â”‚  - ã‚·ã‚¹ãƒ†ãƒ è¨­å®š   â”‚              â”‚   yaml              â”‚
â”‚  - ãƒ‘ã‚¹è¨­å®š      â”‚              â”‚  - ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆé …ç›®     â”‚
â”‚  - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿    â”‚              â”‚  - ãƒ‡ãƒ¼ã‚¿å±æ€§        â”‚
â”‚  - æ¯é›†å›£åˆ†å¸ƒ    â”‚              â”‚  - åˆ†æè¨­å®š         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

### modules/data_analyser.py

**å½¹å‰²**: å‰å‡¦ç†æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã®çµ±è¨ˆåˆ†æ

---

### ã‚¯ãƒ©ã‚¹è¨­è¨ˆ

```python
class SurveyDataAnalyser:
    """ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿åˆ†æã‚¯ãƒ©ã‚¹"""
    
    def __init__(self, config_file: str = 'config/survey_questions.yaml',
                 main_config_file: str = 'config/config.yaml'):
        """
        åˆæœŸåŒ–
        
        è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ä»¥ä¸‹ã‚’èª­ã¿è¾¼ã¿:
        - ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆé …ç›®å®šç¾©
        - åˆ†æè¨­å®šï¼ˆä¿¡é ¼æ°´æº–ã€æœ‰æ„æ°´æº–ãªã©ï¼‰
        - åˆ†æå¯¾è±¡é …ç›®ã®ãƒªã‚¹ãƒˆ
        """
    
    def load_data(self, filepath: str):
        """
        å‰å‡¦ç†æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
        
        Args:
            filepath: å‰å‡¦ç†æ¸ˆã¿CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
        """
    
    # ==========================================
    # 1. åŸºæœ¬åˆ†æ
    # ==========================================
    
    def calculate_descriptive_statistics(self) -> Dict[str, Any]:
        """
        è¨˜è¿°çµ±è¨ˆã®è¨ˆç®—
        
        è¨ˆç®—å†…å®¹:
        - å¹³å‡å€¤ï¼ˆmeanï¼‰
        - ä¸­å¤®å€¤ï¼ˆmedianï¼‰
        - æ¨™æº–åå·®ï¼ˆstdï¼‰
        - æœ€å°å€¤ãƒ»æœ€å¤§å€¤
        - å››åˆ†ä½æ•°ï¼ˆQ1, Q3ï¼‰
        - æ¬ ææ•°
        
        Returns:
            å„é …ç›®ã®è¨˜è¿°çµ±è¨ˆé‡
        """
    
    def calculate_satisfaction_distribution(self) -> Dict[str, Any]:
        """
        æº€è¶³åº¦åˆ†å¸ƒã®è¨ˆç®—
        
        è¨ˆç®—å†…å®¹:
        - å„è©•ä¾¡å€¤ï¼ˆ1-5ï¼‰ã®ä»¶æ•°ãƒ»å‰²åˆ
        - æº€è¶³ä»¥ä¸Šï¼ˆ4-5ç‚¹ï¼‰ã®å‰²åˆ
        - ä¸æº€ä»¥ä¸‹ï¼ˆ1-2ç‚¹ï¼‰ã®å‰²åˆ
        
        Returns:
            æº€è¶³åº¦åˆ†å¸ƒãƒ‡ãƒ¼ã‚¿
        """
    
    def calculate_confidence_intervals(self, 
                                      columns: List[str],
                                      confidence_level: float = 0.95) -> Dict[str, Dict]:
        """
        ä¿¡é ¼åŒºé–“ã®è¨ˆç®—
        
        è¨ˆç®—å¼:
        ä¿¡é ¼åŒºé–“ä¸‹é™ = å¹³å‡å€¤ - Z Ã— æ¨™æº–èª¤å·®
        ä¿¡é ¼åŒºé–“ä¸Šé™ = å¹³å‡å€¤ + Z Ã— æ¨™æº–èª¤å·®
        æ¨™æº–èª¤å·® = æ¨™æº–åå·® Ã· âˆšn
        
        Args:
            columns: å¯¾è±¡ã‚«ãƒ©ãƒ ã®ãƒªã‚¹ãƒˆ
            confidence_level: ä¿¡é ¼æ°´æº–ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ95%ï¼‰
        
        Returns:
            å„é …ç›®ã®ä¿¡é ¼åŒºé–“æƒ…å ±
        """
    
    # ==========================================
    # 2. ç·åˆæº€è¶³åº¦ã®ç®—å‡º
    # ==========================================
    
    def calculate_overall_satisfaction_direct(self) -> Dict[str, float]:
        """
        ç›´æ¥æ¸¬å®šæ³•ã«ã‚ˆã‚‹ç·åˆæº€è¶³åº¦
        
        æ–¹æ³•:
        ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã®ã€Œç·åˆæº€è¶³åº¦ã€é …ç›®ã‚’ãã®ã¾ã¾ä½¿ç”¨
        
        Returns:
            ç·åˆæº€è¶³åº¦ã®çµ±è¨ˆé‡
        """
    
    def calculate_overall_satisfaction_simple_average(self,
                                                      items: List[str]) -> Dict[str, float]:
        """
        å˜ç´”å¹³å‡æ³•ã«ã‚ˆã‚‹ç·åˆæº€è¶³åº¦
        
        è¨ˆç®—å¼:
        ç·åˆæº€è¶³åº¦ = Î£(å„é …ç›®ã®æº€è¶³åº¦) Ã· é …ç›®æ•°
        
        Args:
            items: æº€è¶³åº¦é …ç›®ã®ãƒªã‚¹ãƒˆ
        
        Returns:
            ç·åˆæº€è¶³åº¦ã®çµ±è¨ˆé‡
        """
    
    def calculate_overall_satisfaction_weighted(self,
                                               satisfaction_items: List[str],
                                               importance_items: List[str]) -> Dict[str, float]:
        """
        é‡è¦åº¦åŠ é‡å¹³å‡æ³•ã«ã‚ˆã‚‹ç·åˆæº€è¶³åº¦
        
        è¨ˆç®—å¼:
        ç·åˆæº€è¶³åº¦ = Î£(å„é …ç›®ã®æº€è¶³åº¦ Ã— é‡è¦åº¦) Ã· Î£(é‡è¦åº¦)
        
        Args:
            satisfaction_items: æº€è¶³åº¦é …ç›®ã®ãƒªã‚¹ãƒˆ
            importance_items: å¯¾å¿œã™ã‚‹é‡è¦åº¦é …ç›®ã®ãƒªã‚¹ãƒˆ
        
        Returns:
            ç·åˆæº€è¶³åº¦ã®çµ±è¨ˆé‡
        """
    
    # ==========================================
    # 3. ç›¸é–¢åˆ†æ
    # ==========================================
    
    def calculate_correlations(self,
                               target_column: str,
                               analysis_columns: List[str]) -> Dict[str, Dict]:
        """
        ç›¸é–¢åˆ†æï¼ˆãƒ”ã‚¢ã‚½ãƒ³ç›¸é–¢ä¿‚æ•°ï¼‰
        
        åˆ†æå†…å®¹:
        - ç·åˆæº€è¶³åº¦ã¨å„é …ç›®ã®ç›¸é–¢
        - é‡è¦åº¦ã¨æº€è¶³åº¦ã®ç›¸é–¢
        - åˆ©ç”¨é »åº¦ã¨æº€è¶³åº¦ã®ç›¸é–¢
        
        Args:
            target_column: ç›®çš„å¤‰æ•°ï¼ˆä¾‹: ç·åˆæº€è¶³åº¦ï¼‰
            analysis_columns: èª¬æ˜å¤‰æ•°ã®ãƒªã‚¹ãƒˆ
        
        Returns:
            ç›¸é–¢ä¿‚æ•°ã¨æœ‰æ„ç¢ºç‡ï¼ˆpå€¤ï¼‰
        """
    
    def calculate_correlation_matrix(self,
                                    columns: List[str]) -> pd.DataFrame:
        """
        ç›¸é–¢è¡Œåˆ—ã®è¨ˆç®—
        
        Args:
            columns: åˆ†æå¯¾è±¡ã‚«ãƒ©ãƒ ã®ãƒªã‚¹ãƒˆ
        
        Returns:
            ç›¸é–¢è¡Œåˆ—ï¼ˆDataFrameï¼‰
        """
    
    # ==========================================
    # 4. å±æ€§åˆ¥åˆ†æ
    # ==========================================
    
    def analyze_by_attribute(self,
                            satisfaction_column: str,
                            attribute_column: str) -> Dict[str, Any]:
        """
        å±æ€§åˆ¥æº€è¶³åº¦ã®åˆ†æ
        
        åˆ†æå†…å®¹:
        - å„å±æ€§ã‚°ãƒ«ãƒ¼ãƒ—ã®è¨˜è¿°çµ±è¨ˆ
        - ã‚°ãƒ«ãƒ¼ãƒ—é–“ã®å¹³å‡å€¤æ¯”è¼ƒ
        
        Args:
            satisfaction_column: æº€è¶³åº¦ã‚«ãƒ©ãƒ 
            attribute_column: å±æ€§ã‚«ãƒ©ãƒ ï¼ˆéƒ¨ç½²ã€è·ä½ãªã©ï¼‰
        
        Returns:
            å±æ€§åˆ¥çµ±è¨ˆé‡
        """
    
    # ==========================================
    # 5. IPAåˆ†æï¼ˆé‡è¦åº¦ãƒ»æº€è¶³åº¦åˆ†æï¼‰
    # ==========================================
    
    def perform_ipa_analysis(self,
                            satisfaction_items: List[str],
                            importance_items: List[str]) -> Dict[str, Any]:
        """
        IPAåˆ†æã®å®Ÿè¡Œ
        
        åˆ†ææ‰‹é †:
        1. å„é …ç›®ã®æº€è¶³åº¦ãƒ»é‡è¦åº¦ã®å¹³å‡ã‚’ç®—å‡º
        2. ä¸­å¤®å€¤ï¼ˆã¾ãŸã¯å¹³å‡å€¤ï¼‰ã§4è±¡é™ã«åˆ†å‰²
        3. å„é …ç›®ã‚’è±¡é™ã«åˆ†é¡
        
        è±¡é™ã®å®šç¾©:
        - ç¬¬â… è±¡é™ï¼ˆå³ä¸Šï¼‰: é‡è¦åº¦é«˜ãƒ»æº€è¶³åº¦é«˜ â†’ ç¶­æŒã‚¨ãƒªã‚¢
        - ç¬¬â…¡è±¡é™ï¼ˆå·¦ä¸Šï¼‰: é‡è¦åº¦é«˜ãƒ»æº€è¶³åº¦ä½ â†’ æœ€å„ªå…ˆæ”¹å–„ã‚¨ãƒªã‚¢
        - ç¬¬â…¢è±¡é™ï¼ˆå·¦ä¸‹ï¼‰: é‡è¦åº¦ä½ãƒ»æº€è¶³åº¦ä½ â†’ æ”¹å–„æ¤œè¨ã‚¨ãƒªã‚¢
        - ç¬¬â…£è±¡é™ï¼ˆå³ä¸‹ï¼‰: é‡è¦åº¦ä½ãƒ»æº€è¶³åº¦é«˜ â†’ éå‰°å“è³ªã‚¨ãƒªã‚¢
        
        Args:
            satisfaction_items: æº€è¶³åº¦é …ç›®ã®ãƒªã‚¹ãƒˆ
            importance_items: å¯¾å¿œã™ã‚‹é‡è¦åº¦é …ç›®ã®ãƒªã‚¹ãƒˆ
        
        Returns:
            IPAåˆ†æçµæœï¼ˆè±¡é™åˆ†é¡ã€æ”¹å–„å„ªå…ˆé †ä½ï¼‰
        """
    
    def classify_ipa_quadrant(self,
                             satisfaction: float,
                             importance: float,
                             satisfaction_median: float,
                             importance_median: float) -> str:
        """
        IPAè±¡é™ã®åˆ†é¡
        
        Args:
            satisfaction: æº€è¶³åº¦ã‚¹ã‚³ã‚¢
            importance: é‡è¦åº¦ã‚¹ã‚³ã‚¢
            satisfaction_median: æº€è¶³åº¦ã®ä¸­å¤®å€¤
            importance_median: é‡è¦åº¦ã®ä¸­å¤®å€¤
        
        Returns:
            è±¡é™åï¼ˆ'â… ', 'â…¡', 'â…¢', 'â…£'ï¼‰
        """
    
    # ==========================================
    # 6. åˆ†æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
    # ==========================================
    
    def analysis_pipeline(self) -> Dict[str, Any]:
        """
        åˆ†æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®å®Ÿè¡Œ
        
        å®Ÿè¡Œé †åº:
        1. åŸºæœ¬åˆ†æï¼ˆè¨˜è¿°çµ±è¨ˆã€åˆ†å¸ƒï¼‰
        2. ä¿¡é ¼åŒºé–“ã®è¨ˆç®—
        3. ç·åˆæº€è¶³åº¦ã®ç®—å‡ºï¼ˆ3æ‰‹æ³•ï¼‰
        4. ç›¸é–¢åˆ†æ
        5. å±æ€§åˆ¥åˆ†æ
        6. IPAåˆ†æ
        
        Returns:
            å…¨åˆ†æçµæœã‚’å«ã‚€è¾æ›¸
        """
    
    def save_analysis_results(self, output_path: str):
        """
        åˆ†æçµæœã®ä¿å­˜
        
        Args:
            output_path: å‡ºåŠ›å…ˆãƒ‘ã‚¹ï¼ˆJSONå½¢å¼ï¼‰
        """
```

---

### è¨­è¨ˆåˆ¤æ–­

#### 1. 3ã¤ã®ç·åˆæº€è¶³åº¦ç®—å‡ºæ–¹æ³•

**ç†ç”±**: 
- ç›´æ¥æ¸¬å®š: å›ç­”è€…ã®ç›´æ„Ÿçš„åˆ¤æ–­ã‚’åæ˜ 
- å˜ç´”å¹³å‡: ç®—å‡ºãŒç°¡å˜ã§ç†è§£ã—ã‚„ã™ã„
- é‡è¦åº¦åŠ é‡: æœ€ã‚‚ç²¾ç·»ã§æˆ¦ç•¥çš„

**å®Ÿè£…**:
```python
overall_satisfaction = {
    'direct': self.calculate_overall_satisfaction_direct(),
    'simple_average': self.calculate_overall_satisfaction_simple_average(items),
    'weighted_average': self.calculate_overall_satisfaction_weighted(sat_items, imp_items)
}
```

#### 2. å±æ€§åˆ¥åˆ†æã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

**è¨˜è¿°çµ±è¨ˆã«ã‚ˆã‚‹æ¯”è¼ƒ**:
```python
# å„ã‚°ãƒ«ãƒ¼ãƒ—ã®å¹³å‡å€¤ã€æ¨™æº–åå·®ã€ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã‚’è¨ˆç®—
for group in groups:
    group_stats = calculate_group_statistics(group)
    
# ã‚°ãƒ«ãƒ¼ãƒ—é–“ã®å·®ç•°ã‚’å¯è¦–åŒ–
plot_group_comparison(groups)
```

#### 3. IPAåˆ†æã®ä¸­å¤®å€¤è¨­å®š

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: ãƒ‡ãƒ¼ã‚¿ã®ä¸­å¤®å€¤ã‚’ä½¿ç”¨

**ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½**:
```yaml
# config.yaml
analysis:
  ipa:
    split_method: "median"  # median or mean or custom
    custom_satisfaction_threshold: 3.0
    custom_importance_threshold: 3.5
```

---

## ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

### modules/report_generator.py

**å½¹å‰²**: åˆ†æçµæœã‚’å¯è¦–åŒ–ã—ã€ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ

---

### ã‚¯ãƒ©ã‚¹è¨­è¨ˆ

```python
class SurveyReportGenerator:
    """ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆåˆ†æãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã‚¯ãƒ©ã‚¹"""
    
    def __init__(self, 
                 analysis_results: Dict[str, Any],
                 config_file: str = 'config/config.yaml'):
        """
        åˆæœŸåŒ–
        
        Args:
            analysis_results: DataAnalyserã®åˆ†æçµæœ
            config_file: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
        """
    
    # ==========================================
    # 1. ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼
    # ==========================================
    
    def generate_executive_summary(self) -> Dict[str, Any]:
        """
        ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼ã®ç”Ÿæˆ
        
        å†…å®¹:
        - èª¿æŸ»æ¦‚è¦
        - ç·åˆæº€è¶³åº¦
        - æº€è¶³åº¦åˆ†å¸ƒ
        - æœ€å„ªå…ˆæ”¹å–„é …ç›®ï¼ˆTop 3ï¼‰
        - ç¶­æŒãƒ»å¼·åŒ–é …ç›®ï¼ˆTop 3ï¼‰
        
        Returns:
            ã‚µãƒãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿
        """
    
    # ==========================================
    # 2. ã‚°ãƒ©ãƒ•ç”Ÿæˆ
    # ==========================================
    
    def plot_satisfaction_distribution(self,
                                      item: str,
                                      output_path: str = None) -> str:
        """
        æº€è¶³åº¦åˆ†å¸ƒã®æ£’ã‚°ãƒ©ãƒ•
        
        Args:
            item: åˆ†æå¯¾è±¡é …ç›®
            output_path: ä¿å­˜å…ˆãƒ‘ã‚¹
        
        Returns:
            ä¿å­˜å…ˆãƒ‘ã‚¹
        """
    
    def plot_satisfaction_ranking(self,
                                 items: List[str],
                                 output_path: str = None) -> str:
        """
        æº€è¶³åº¦ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®æ¨ªæ£’ã‚°ãƒ©ãƒ•
        
        Args:
            items: æ¯”è¼ƒå¯¾è±¡é …ç›®ã®ãƒªã‚¹ãƒˆ
            output_path: ä¿å­˜å…ˆãƒ‘ã‚¹
        
        Returns:
            ä¿å­˜å…ˆãƒ‘ã‚¹
        """
    
    def plot_correlation_heatmap(self,
                                correlation_matrix: pd.DataFrame,
                                output_path: str = None) -> str:
        """
        ç›¸é–¢è¡Œåˆ—ã®ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—
        
        Args:
            correlation_matrix: ç›¸é–¢è¡Œåˆ—
            output_path: ä¿å­˜å…ˆãƒ‘ã‚¹
        
        Returns:
            ä¿å­˜å…ˆãƒ‘ã‚¹
        """
    
    def plot_attribute_comparison(self,
                                  attribute_analysis: Dict[str, Any],
                                  output_path: str = None) -> str:
        """
        å±æ€§åˆ¥æ¯”è¼ƒã®ç®±ã²ã’å›³ã¾ãŸã¯æ£’ã‚°ãƒ©ãƒ•
        
        Args:
            attribute_analysis: å±æ€§åˆ¥åˆ†æçµæœ
            output_path: ä¿å­˜å…ˆãƒ‘ã‚¹
        
        Returns:
            ä¿å­˜å…ˆãƒ‘ã‚¹
        """
    
    def plot_ipa_matrix(self,
                       ipa_results: Dict[str, Any],
                       output_path: str = None) -> str:
        """
        IPAåˆ†æã®ãƒãƒˆãƒªãƒƒã‚¯ã‚¹å›³
        
        ã‚°ãƒ©ãƒ•æ§‹æˆ:
        - Xè»¸: æº€è¶³åº¦
        - Yè»¸: é‡è¦åº¦
        - 4è±¡é™ã‚’è‰²åˆ†ã‘
        - å„é …ç›®ã‚’ãƒ—ãƒ­ãƒƒãƒˆï¼ˆãƒ©ãƒ™ãƒ«ä»˜ãï¼‰
        
        Args:
            ipa_results: IPAåˆ†æçµæœ
            output_path: ä¿å­˜å…ˆãƒ‘ã‚¹
        
        Returns:
            ä¿å­˜å…ˆãƒ‘ã‚¹
        """
    
    # ==========================================
    # 3. ãƒ†ã‚­ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
    # ==========================================
    
    def generate_text_report(self, output_path: str):
        """
        ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã®è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
        
        æ§‹æˆ:
        1. ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼
        2. èª¿æŸ»æ¦‚è¦
        3. åŸºæœ¬åˆ†æçµæœ
        4. è©³ç´°åˆ†æçµæœ
        5. æ”¹å–„æè¨€
        
        Args:
            output_path: å‡ºåŠ›å…ˆãƒ‘ã‚¹ï¼ˆ.txtå½¢å¼ï¼‰
        """
    
    def generate_markdown_report(self, output_path: str):
        """
        Markdownå½¢å¼ã®ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
        
        Args:
            output_path: å‡ºåŠ›å…ˆãƒ‘ã‚¹ï¼ˆ.mdå½¢å¼ï¼‰
        """
    
    # ==========================================
    # 4. HTMLãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
    # ==========================================
    
    def generate_html_report(self, output_path: str):
        """
        HTMLå½¢å¼ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
        
        å†…å®¹:
        - Bootstrap CSSã§ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°
        - ã‚°ãƒ©ãƒ•ã‚’ç”»åƒã¨ã—ã¦åŸ‹ã‚è¾¼ã¿
        - è¡¨å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
        - ç›®æ¬¡ã¨ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
        
        Args:
            output_path: å‡ºåŠ›å…ˆãƒ‘ã‚¹ï¼ˆ.htmlå½¢å¼ï¼‰
        """
    
    # ==========================================
    # 5. PDFãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
    # ==========================================
    
    def generate_pdf_report(self, output_path: str):
        """
        PDFå½¢å¼ã®ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
        
        Args:
            output_path: å‡ºåŠ›å…ˆãƒ‘ã‚¹ï¼ˆ.pdfå½¢å¼ï¼‰
        """
    
    # ==========================================
    # 6. ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
    # ==========================================
    
    def generate_all_reports(self, output_dir: str = 'out/reports'):
        """
        å…¨å½¢å¼ã®ãƒ¬ãƒãƒ¼ãƒˆä¸€æ‹¬ç”Ÿæˆ
        
        ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«:
        - executive_summary.txt
        - detailed_report.md
        - interactive_report.html
        - final_report.pdf
        - graphs/*.png (å„ç¨®ã‚°ãƒ©ãƒ•)
        
        Args:
            output_dir: å‡ºåŠ›å…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
        """
```

---

### ã‚°ãƒ©ãƒ•è¨­è¨ˆã®è©³ç´°

#### 1. æº€è¶³åº¦åˆ†å¸ƒã‚°ãƒ©ãƒ•

```python
def plot_satisfaction_distribution(self, item: str, output_path: str = None):
    """
    ç¸¦æ£’ã‚°ãƒ©ãƒ•:
    - Xè»¸: è©•ä¾¡å€¤ï¼ˆ1: éå¸¸ã«ä¸æº€ ï½ 5: éå¸¸ã«æº€è¶³ï¼‰
    - Yè»¸: ä»¶æ•°ã¾ãŸã¯å‰²åˆï¼ˆ%ï¼‰
    - è‰²åˆ†ã‘: 1-2ï¼ˆèµ¤ï¼‰ã€3ï¼ˆé»„ï¼‰ã€4-5ï¼ˆç·‘ï¼‰
    - å¹³å‡å€¤ã‚’ç¸¦ç·šã§è¡¨ç¤º
    """
```

#### 2. IPAåˆ†æãƒãƒˆãƒªãƒƒã‚¯ã‚¹

```python
def plot_ipa_matrix(self, ipa_results: Dict[str, Any], output_path: str = None):
    """
    æ•£å¸ƒå›³:
    - Xè»¸: æº€è¶³åº¦ï¼ˆ1-5ï¼‰
    - Yè»¸: é‡è¦åº¦ï¼ˆ1-4ã¾ãŸã¯1-5ï¼‰
    - ä¸­å¤®ç·š: æº€è¶³åº¦ãƒ»é‡è¦åº¦ã®ä¸­å¤®å€¤
    - è±¡é™ãƒ©ãƒ™ãƒ«: â… ã€œâ…£
    - å„ç‚¹ã«ãƒ©ãƒ™ãƒ«ï¼ˆé …ç›®åï¼‰
    - è‰²åˆ†ã‘:
        * â… ï¼ˆç¶­æŒï¼‰: é’
        * â…¡ï¼ˆæœ€å„ªå…ˆæ”¹å–„ï¼‰: èµ¤
        * â…¢ï¼ˆæ”¹å–„æ¤œè¨ï¼‰: é»„
        * â…£ï¼ˆéå‰°å“è³ªï¼‰: ç·‘
    """
```

---

### ãƒ¬ãƒãƒ¼ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

#### ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼ã®æ§‹æˆ

```markdown
# ITéƒ¨é–€ã‚µãƒ¼ãƒ“ã‚¹æº€è¶³åº¦èª¿æŸ» ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

## èª¿æŸ»æ¦‚è¦
- å®Ÿæ–½æœŸé–“: {start_date} ï½ {end_date}
- å¯¾è±¡è€…: {target_population}
- æœ‰åŠ¹å›ç­”æ•°: {valid_responses}åï¼ˆå›ç­”ç‡{response_rate}%ï¼‰

## ä¸»è¦ãªç™ºè¦‹

### ç·åˆæº€è¶³åº¦
**{overall_satisfaction}ç‚¹ï¼ˆ5ç‚¹æº€ç‚¹ï¼‰**

æº€è¶³åº¦åˆ†å¸ƒ:
- æº€è¶³ä»¥ä¸Šï¼ˆ4ç‚¹ä»¥ä¸Šï¼‰: {satisfied_pct}%
- æ™®é€šï¼ˆ3ç‚¹ï¼‰: {neutral_pct}%
- ä¸æº€ä»¥ä¸‹ï¼ˆ2ç‚¹ä»¥ä¸‹ï¼‰: {dissatisfied_pct}%

### æœ€å„ªå…ˆæ”¹å–„é …ç›®
1. {priority_1} ï¼ˆæº€è¶³åº¦{sat_1}ã€é‡è¦åº¦{imp_1}ï¼‰
2. {priority_2} ï¼ˆæº€è¶³åº¦{sat_2}ã€é‡è¦åº¦{imp_2}ï¼‰
3. {priority_3} ï¼ˆæº€è¶³åº¦{sat_3}ã€é‡è¦åº¦{imp_3}ï¼‰

### ç¶­æŒãƒ»å¼·åŒ–é …ç›®
1. {maintain_1} ï¼ˆæº€è¶³åº¦{sat_1}ã€é‡è¦åº¦{imp_1}ï¼‰
2. {maintain_2} ï¼ˆæº€è¶³åº¦{sat_2}ã€é‡è¦åº¦{imp_2}ï¼‰

## æ”¹å–„æ–½ç­–ã®æè¨€
[IPAåˆ†æã«åŸºã¥ãå…·ä½“çš„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³]
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ï¼ˆæ‹¡å¼µç‰ˆï¼‰

### å…¨ä½“ãƒ•ãƒ­ãƒ¼

```
1. ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
   config/survey_questions.yaml
            â†“
   data_generator.py
            â†“
   csv/survey_sample_data.csv (100è¡ŒÃ—23åˆ—)

2. ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†
   csv/survey_sample_data.csv
            â†“
   data_preprocess.py
     â”œâ”€ ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
     â”œâ”€ æ¬ æå€¤å‡¦ç†
     â”œâ”€ æ¨™æº–åŒ–ãƒ»ãƒªã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
     â””â”€ ä»£è¡¨æ€§æ¤œè¨¼
            â†“
   csv/survey_preprocessed_data.csv (90è¡ŒÃ—76åˆ—)
            â†“
   out/preprocessing_report.json

3. ãƒ‡ãƒ¼ã‚¿åˆ†æ â† æ–°è¦
   csv/survey_preprocessed_data.csv
            â†“
   data_analyser.py
     â”œâ”€ åŸºæœ¬åˆ†æï¼ˆè¨˜è¿°çµ±è¨ˆã€ä¿¡é ¼åŒºé–“ï¼‰
     â”œâ”€ ç·åˆæº€è¶³åº¦ç®—å‡ºï¼ˆ3æ‰‹æ³•ï¼‰
     â”œâ”€ ç›¸é–¢åˆ†æ
     â”œâ”€ å±æ€§åˆ¥åˆ†æï¼ˆANOVAï¼‰
     â””â”€ IPAåˆ†æ
            â†“
   out/analysis_results.json

4. ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ â† æ–°è¦
   out/analysis_results.json
            â†“
   report_generator.py
     â”œâ”€ ã‚°ãƒ©ãƒ•ç”Ÿæˆ
     â”œâ”€ ãƒ†ã‚­ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆ
     â”œâ”€ HTMLãƒ¬ãƒãƒ¼ãƒˆ
     â”œâ”€ Excelãƒ¬ãƒãƒ¼ãƒˆ
     â””â”€ PDFãƒ¬ãƒãƒ¼ãƒˆ
            â†“
   out/reports/
     â”œâ”€ executive_summary.txt
     â”œâ”€ detailed_report.md
     â”œâ”€ interactive_report.html
     â”œâ”€ final_report.pdf
     â””â”€ graphs/*.png
```

---

## è¨­è¨ˆåŸå‰‡ï¼ˆæ›´æ–°ç‰ˆï¼‰

### 1. è¨­å®šé§†å‹•å‹
```yaml
# config.yaml ã«åˆ†æè¨­å®šã‚’è¿½åŠ 
analysis:
  confidence_level: 0.95
  significance_level: 0.05
  
  # ç·åˆæº€è¶³åº¦ç®—å‡º
  overall_satisfaction:
    methods:
      - direct
      - simple_average
      - weighted_average
    primary_method: direct
  
  # IPAåˆ†æ
  ipa:
    split_method: median  # median, mean, custom
    
  # å±æ€§åˆ¥åˆ†æ
  attribute_analysis:
    attributes:
      - department
      - position
      - it_skill_level
    
# ãƒ¬ãƒãƒ¼ãƒˆè¨­å®š
report:
  formats:
    - text
    - markdown
    - html
    - pdf
  
  graphs:
    dpi: 300
    style: seaborn
    color_palette: deep
```

### 2. Fail FaståŸå‰‡ï¼ˆç¶™ç¶šï¼‰

åˆ†ææ®µéšã§ã‚‚ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ã‚’å¾¹åº•:
```python
# ãƒ‡ãƒ¼ã‚¿ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯
if not self._validate_data():
    raise ValueError("ãƒ‡ãƒ¼ã‚¿ãŒåˆ†æã«é©ã—ã¦ã„ã¾ã›ã‚“")

# å¿…é ˆã‚«ãƒ©ãƒ ã®å­˜åœ¨ç¢ºèª
if 'overall_satisfaction' not in self.data.columns:
    raise KeyError("ç·åˆæº€è¶³åº¦ã‚«ãƒ©ãƒ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
```

### 3. é–¢å¿ƒã®åˆ†é›¢ï¼ˆæ‹¡å¼µï¼‰

```
data_analyser.py    â†’ åˆ†æãƒ­ã‚¸ãƒƒã‚¯ã®ã¿
report_generator.py â†’ å¯è¦–åŒ–ãƒ»ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã®ã¿
util.py            â†’ è¡¨ç¤ºãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
```

### 4. æ‹¡å¼µæ€§ï¼ˆå®Ÿç¾ï¼‰

æ–°ã—ã„åˆ†ææ‰‹æ³•ã®è¿½åŠ ãŒå®¹æ˜“:
```python
# æ–°ã—ã„åˆ†ææ‰‹æ³•ã‚’è¿½åŠ 
def perform_regression_analysis(self, ...):
    """å›å¸°åˆ†æã®å®Ÿè¡Œ"""
    pass

def perform_factor_analysis(self, ...):
    """å› å­åˆ†æã®å®Ÿè¡Œ"""
    pass
```

### 5. ä¿å®ˆæ€§ï¼ˆç¶™ç¶šï¼‰

- YAMLã§åˆ†æãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç®¡ç†
- ã‚°ãƒ©ãƒ•ã‚¹ã‚¿ã‚¤ãƒ«ã®ä¸€å…ƒç®¡ç†
- ãƒ¬ãƒãƒ¼ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®åˆ†é›¢

---

## ã¾ã¨ã‚

### å®Ÿè£…å®Œäº†äºˆå®š

#### Phase 1: ãƒ‡ãƒ¼ã‚¿åé›†ãƒ»å‰å‡¦ç†ï¼ˆå®Œäº†ï¼‰
- âœ… data_generator.py
- âœ… data_preprocess.py
- âœ… ä»£è¡¨æ€§æ¤œè¨¼æ©Ÿèƒ½

#### Phase 2: ãƒ‡ãƒ¼ã‚¿åˆ†æï¼ˆæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼‰
- ğŸ“‹ data_analyser.py
  - åŸºæœ¬åˆ†æ
  - ç·åˆæº€è¶³åº¦ç®—å‡º
  - ç›¸é–¢åˆ†æ
  - å±æ€§åˆ¥åˆ†æ
  - IPAåˆ†æ

#### Phase 3: ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆï¼ˆæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼‰
- ğŸ“‹ report_generator.py
  - ã‚°ãƒ©ãƒ•ç”Ÿæˆ
  - ãƒ†ã‚­ã‚¹ãƒˆã€Markdownã€HTMLã€PDFãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›

### ã‚³ãƒ¼ãƒ‰ã®å“è³ª

- **ä¸€è²«æ€§**: æ—¢å­˜ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨åŒã˜è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³
- **ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£**: å„ãƒ¡ã‚½ãƒƒãƒ‰ãŒç‹¬ç«‹ã—ã¦å‹•ä½œ
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: è©³ç´°ãªdocstringã¨å‹ãƒ’ãƒ³ãƒˆ
- **è¨­å®šé§†å‹•**: YAMLã§æŸ”è»Ÿã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½

### ä»Šå¾Œã®æ‹¡å¼µ

- å› å­åˆ†æãƒ»ä¸»æˆåˆ†åˆ†æ
- å›å¸°åˆ†æï¼ˆé‡å›å¸°ã€ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ï¼‰
- ãƒ†ã‚­ã‚¹ãƒˆãƒã‚¤ãƒ‹ãƒ³ã‚°ï¼ˆè‡ªç”±è¨˜è¿°åˆ†æï¼‰
- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰UI
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ†ææ©Ÿèƒ½

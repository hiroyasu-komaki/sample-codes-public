# IT部門サービス満足度アンケート データ分析プログラム

統計アプローチに基づいた包括的なアンケートデータ分析システム

## 概要

このプログラムは、IT部門の社内サービス満足度アンケートのデータ分析を自動化します。
統計的に正確な分析手法を用いて、以下の分析を実施します：

- データクリーニング（欠損値処理、代表性確認）
- 基本統計（記述統計、95%信頼区間）
- 相関分析
- 属性別分析（部署別、職位別、ITスキル別）
- IPA分析（重要度-満足度分析）
- 回帰分析
- 改善優先順位の決定

## ファイル構成

```
main.py              - メインプログラム（エントリポイント）
data_generator.py    - サンプルデータ生成モジュール
data_analyser.py     - データ分析モジュール
report_generator.py  - レポート生成モジュール
survey_questions.yaml - アンケート項目定義ファイル
requirements.txt     - 必要なパッケージ一覧
```

## 仮想環境

```bash
python3 -m venv venv
source venv/bin/activate  # Linux/macOS
```

## 必要なパッケージ

```bash
pip install -r requirements.txt
```

または個別にインストール：

```bash
pip install pandas numpy scipy pyyaml
```

## 使用方法

### 1. 対話形式での実行

```bash
python main.py
```

実行時に以下の質問が表示されます：

**サンプルデータを生成しますか？ (Y/N)**
- Y: 新しいサンプルデータを生成（100件）して分析を実行
- N: 既存のデータファイル（survey_sample_data.csv）を使用して分析を実行

データの選択後、自動的に分析が実行され、レポートが生成されます。

### 2. 既存データで分析を実行

既存のデータファイル（survey_sample_data.csv）がある場合：

```bash
python main.py
```

「サンプルデータを生成しますか？」で **N** を選択すると、
既存データで自動的に分析が実行されます。

## 出力ファイル

### analysis_report.txt

包括的な分析レポート（テキスト形式）

**内容：**
- データ品質評価
- 基本統計（記述統計）
- 相関分析
- 属性別分析
- IPA分析
- 回帰分析
- 改善優先順位
- 推奨アクション

## 分析手法

### データクリーニング

- **欠損値処理**
  - 欠損率 < 5%: リストワイズ削除
  - 欠損率 5-15%: 平均値補完
  
- **代表性確認**
  - 回答者属性の分布を確認
  - 母集団との乖離を評価

### 基本統計

- 各満足度項目の平均値、標準偏差
- 95%信頼区間の算出（t分布使用）
- 満足度分布の可視化

### 相関分析

- 総合満足度と各項目の相関係数
- p値による有意性検定

### 属性別分析

- 部署別、職位別、ITスキル別の満足度比較
- 分散分析（ANOVA）による有意差検定

### IPA分析

重要度と満足度のマトリクス分析：
- **第1象限（最優先改善エリア）**: 重要度高・満足度低
- **第2象限（維持エリア）**: 重要度高・満足度高
- **第3象限（改善検討エリア）**: 重要度低・満足度低
- **第4象限（過剰品質エリア）**: 重要度低・満足度高

### 回帰分析

総合満足度を目的変数とした各項目の影響度分析
- 標準化係数の算出
- 影響度ランキング

### 改善優先順位

IPA分析と満足度に基づく優先順位決定：
1. 最優先改善項目
2. 改善推奨項目
3. 維持項目

## 統計的根拠

本プログラムの分析手法は以下の統計的原則に基づいています：

- **95%信頼区間**: t分布を用いた厳密な計算
- **有意性検定**: p < 0.05を統計的有意の基準
- **サンプルサイズ**: 必要サンプル数357件（95%CI、±5%誤差）
- **欠損値処理**: 統計的に適切な方法の選択

## 実行例

```
$ python main.py

======================================================================
IT部門サービス満足度アンケート
データ生成・分析プログラム
======================================================================

サンプルデータを生成しますか？ (Y/N): N

既存のデータファイルを使用します: survey_sample_data.csv

======================================================================
データ分析実行
======================================================================

データ読込中: survey_sample_data.csv
✓ 100件のデータを読み込みました

======================================================================
データ分析実行中...
======================================================================

[1/7] データクリーニング...
[2/7] 基本分析（記述統計）...
[3/7] 相関分析...
[4/7] 属性別分析...
[5/7] IPA分析（重要度-満足度分析）...
[6/7] 回帰分析...
[7/7] 改善優先順位の決定...

分析完了！

レポート生成中...
✓ テキストレポート: analysis_report.txt

======================================================================
分析完了！
======================================================================

処理が完了しました。
```

## 注意事項

- データファイル（survey_sample_data.csv）は同じディレクトリに配置してください
- survey_questions.yamlファイルが必要です
- Python 3.8以上を推奨

## ライセンス

このプログラムは教育・研究目的で作成されています。

## サポート

問題が発生した場合は、エラーメッセージを確認してください。
主な原因：
- 必要なパッケージがインストールされていない
- データファイルが見つからない
- データ形式が正しくない

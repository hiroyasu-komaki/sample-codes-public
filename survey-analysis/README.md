# IT部門サービス満足度アンケート データ分析プログラム

統計アプローチに基づいた包括的なアンケートデータ分析システム

## 概要

このプログラムは、IT部門の社内サービス満足度アンケートのデータ分析を自動化します。
統計的に正確な分析手法を用いて、以下の分析を実施します：

- データクリーニング（欠損値処理、代表性確認）
- 基本統計（記述統計、95%信頼区間）
- 相関分析
- 属性別分析（部署別、職位別、ITスキル別）
- IPA分析（重要度-満足度分析）
- 回帰分析
- 改善優先順位の決定

## プロジェクト構成

```
プロジェクトルート/
├── config/                      # 設定ファイル
│   ├── config.yaml             # メイン設定ファイル
│   └── survey_questions.yaml   # アンケート項目定義
├── modules/                     # Pythonモジュール
│   ├── data_generator.py       # サンプルデータ生成
│   ├── data_analyser.py        # データ分析
│   └── report_generator.py     # レポート生成
├── csv/                         # CSVデータファイル
│   └── survey_sample_data.csv  # サンプルデータ（生成後）
├── out/                         # 出力ファイル
│   └── analysis_report.txt     # 分析レポート（生成後）
├── main.py                      # メインプログラム
├── requirements.txt             # 必要なパッケージ一覧
└── README.md                    # このファイル
```

## セットアップ

### 1. 仮想環境の作成（推奨）

```bash
python3 -m venv venv
source venv/bin/activate  # Linux/macOS
# または
venv\Scripts\activate     # Windows
```

### 2. 必要なパッケージのインストール

```bash
pip install -r requirements.txt
```

必要なパッケージ：
- pandas
- numpy
- scipy
- pyyaml

## 設定ファイル

### config/config.yaml

アプリケーションの全体設定を管理：

```yaml
# ディレクトリ構成
directories:
  config: "config"
  csv: "csv"
  output: "out"
  modules: "modules"

# ファイルパス
files:
  survey_questions: "config/survey_questions.yaml"
  sample_data: "csv/survey_sample_data.csv"
  analysis_report: "out/analysis_report.txt"

# データ生成設定
data_generation:
  default_sample_size: 100
  random_seed: 42
  missing_rate: 0.05

# 分析設定
analysis:
  confidence_level: 0.95
  significance_level: 0.05
```

### config/survey_questions.yaml

アンケート項目の定義ファイル：
- 回答者属性（部署、職位、勤続年数、ITスキル）
- サービス利用状況
- 満足度評価（5段階）
- 重要度評価（4段階）
- 改善要望

## 使用方法

### 1. 基本的な実行

```bash
python main.py
```

実行時に以下の質問が表示されます：

**サンプルデータを生成しますか？ (Y/N)**
- **Y**: 新しいサンプルデータを生成（デフォルト100件）して分析を実行
- **N**: 既存のデータファイル（`csv/survey_sample_data.csv`）を使用して分析を実行

データの選択後、自動的に分析が実行され、レポートが生成されます。

### 2. 既存データで分析を実行

既存のデータファイル（`csv/survey_sample_data.csv`）がある場合：

```bash
python main.py
```

「サンプルデータを生成しますか？」で **N** を選択すると、
既存データで自動的に分析が実行されます。

### 3. カスタム設定での実行

`config/config.yaml`を編集することで、以下をカスタマイズできます：
- サンプルサイズ（`default_sample_size`）
- 欠損値率（`missing_rate`）
- ファイルパス
- ディレクトリ構成

## 出力ファイル

### out/analysis_report.txt

包括的な分析レポート（テキスト形式）

**内容：**
1. データ品質評価
   - サンプル情報
   - 欠損値率
   - 代表性の確認

2. 基本統計（記述統計）
   - 満足度評価の平均値、標準偏差
   - 95%信頼区間
   - 満足度分布

3. 相関分析
   - 総合満足度と各項目の相関係数
   - 有意性検定（p値）

4. 属性別分析
   - 部署別、職位別、ITスキル別の満足度比較
   - 分散分析（ANOVA）

5. IPA分析（重要度-満足度分析）
   - 4象限マトリクス分析
   - 各項目の位置づけ

6. 回帰分析
   - 総合満足度への影響度分析
   - 標準化係数とランキング

7. 改善優先順位
   - 最優先改善項目
   - 改善推奨項目
   - 維持項目

8. 推奨アクション
   - 短期施策（1-3ヶ月）
   - 中期施策（3-6ヶ月）
   - 長期施策（6-12ヶ月）

### csv/survey_sample_data.csv

生成されたサンプルデータ（CSV形式）
- 回答者属性
- サービス利用状況
- 満足度評価
- 重要度評価
- 改善要望

## 分析手法

### データクリーニング

- **欠損値処理**
  - 欠損率 < 5%: リストワイズ削除
  - 欠損率 5-15%: 平均値補完
  
- **代表性確認**
  - 回答者属性の分布を確認
  - 母集団との乖離を評価

### 基本統計

- 各満足度項目の平均値、標準偏差
- 95%信頼区間の算出（t分布使用）
- 満足度分布の可視化

### 相関分析

- 総合満足度と各項目の相関係数
- p値による有意性検定
- 相関の強さの解釈

### 属性別分析

- 部署別、職位別、ITスキル別の満足度比較
- 分散分析（ANOVA）による有意差検定
- F値とp値の算出

### IPA分析

重要度と満足度のマトリクス分析：
- **第1象限（最優先改善エリア）**: 重要度高・満足度低
- **第2象限（維持エリア）**: 重要度高・満足度高
- **第3象限（改善検討エリア）**: 重要度低・満足度低
- **第4象限（過剰品質エリア）**: 重要度低・満足度高

### 回帰分析

総合満足度を目的変数とした各項目の影響度分析
- 標準化係数の算出
- 影響度ランキング
- サンプルサイズの考慮

### 改善優先順位

IPA分析と満足度に基づく優先順位決定：
1. 最優先改善項目（重要度高・満足度低）
2. 改善推奨項目（満足度向上の余地あり）
3. 維持項目（現状の水準を維持）

## 統計的根拠

本プログラムの分析手法は以下の統計的原則に基づいています：

- **95%信頼区間**: t分布を用いた厳密な計算
- **有意性検定**: p < 0.05を統計的有意の基準
- **サンプルサイズ**: 必要サンプル数357件（95%CI、±5%誤差）
- **欠損値処理**: 統計的に適切な方法の選択
- **分散分析**: 多群間の比較にANOVAを使用

## 実行例

```
$ python main.py

======================================================================
IT部門サービス満足度アンケート
データ生成・分析プログラム
======================================================================

サンプルデータを生成しますか？ (Y/N): Y

======================================================================
サンプルデータ生成
======================================================================

設定読込: config/survey_questions.yaml
データ生成中... (100件)

----------------------------------------------------------------------
生成データ統計
----------------------------------------------------------------------
総サンプル数: 100件

満足度評価の統計:
項目                      平均     標準偏差 
----------------------------------------------------------------------
総合満足度                 3.01    1.01    
対応スピード               2.99    0.96    
技術的解決力               3.02    1.01    
説明のわかりやすさ          2.97    1.00    
対応の丁寧さ               3.04    0.98    
システムの安定性            2.98    0.99    
セキュリティ対策            3.00    1.02    
新システム導入支援          2.96    1.03    
----------------------------------------------------------------------

✓ データ生成完了: csv/survey_sample_data.csv

======================================================================
データ分析実行
======================================================================

データ読込中: csv/survey_sample_data.csv
✓ 100件のデータを読み込みました

======================================================================
データ分析実行中...
======================================================================

[1/7] データクリーニング...
[2/7] 基本分析（記述統計）...
[3/7] 相関分析...
[4/7] 属性別分析...
[5/7] IPA分析（重要度-満足度分析）...
[6/7] 回帰分析...
[7/7] 改善優先順位の決定...

分析完了！

レポート生成中...
✓ テキストレポート: out/analysis_report.txt

======================================================================
分析完了！
======================================================================

処理が完了しました。
```

## トラブルシューティング

### エラー: config/config.yaml が見つかりません

→ `config/config.yaml`が存在することを確認してください。
   プログラムはデフォルト設定で続行します。

### エラー: csv/survey_sample_data.csv が見つかりません

→ サンプルデータを生成するか、既存のCSVファイルを`csv/`フォルダに配置してください。

### エラー: modules/data_generator.py が見つかりません

→ `modules/`フォルダに必要なPythonファイルが存在することを確認してください。

## カスタマイズ

### サンプルサイズの変更

`config/config.yaml`を編集：

```yaml
data_generation:
  default_sample_size: 200  # 100から200に変更
```

### アンケート項目の追加

`config/survey_questions.yaml`を編集して項目を追加し、
対応する分析モジュールも更新してください。

### 出力先の変更

`config/config.yaml`を編集：

```yaml
directories:
  output: "results"  # outからresultsに変更

files:
  analysis_report: "results/report.txt"
```

## ライセンス

このプログラムは教育・研究目的で作成されています。

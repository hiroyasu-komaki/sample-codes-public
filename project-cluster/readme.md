# Project Portfolio Analyzer

プロジェクトポートフォリオの生成と分析を行うPythonアプリケーションです。YAML設定ファイルに基づいて複数業界のサンプルプロジェクトデータを生成し、ポートフォリオ分析とシグナル分析を実行します。

## 機能概要

- **自動データ生成**: YAML設定に基づいた業界別プロジェクトデータの自動生成
- **ポートフォリオ分析**: 戦略的整合性、リスク、予算、期間などの数値属性に基づく階層クラスタリング
- **シグナル分析**: 技術スタック、ベンダー、スキルセットなどのカテゴリカル属性に基づくクラスタリング
- **類似度分析**: プロジェクト間のJaccard類似度を計算し、高類似度ペアを抽出
- **デンドログラム可視化**: 分析結果をPNG形式で自動出力
- **t-SNE散布図**: プロジェクトの類似度を2次元マップで視覚化
- **複数業界対応**: Healthcare、Manufacturing、Retail、Technology、Financeの5業界に対応

<br>

## プロジェクト構成

```
.
├── config/
│   └── config.yaml          # プロジェクト設定ファイル
├── projects/                # 生成されたCSVデータ（自動作成）
├── data/                    # 統合データ・レポート（自動作成）
│   ├── integrated_projects.csv
│   ├── high_similarity_pairs.csv
│   └── top_similar_projects.csv
├── png/                     # デンドログラム・散布図（自動作成）
│   ├── portfolio_dendrogram.png
│   ├── signal_dendrogram.png
│   └── similarity_scatter_tsne.png
├── main.py                  # メインスクリプト
├── project_data_generator.py
├── portfolio_analyzer.py
├── signal_analyzer.py
├── similarity_insights.py   # 類似度分析モジュール
├── config_loader.py
├── data_loader.py
├── requirements.txt
└── README.md
```

<br>

## 必要要件

- Python 3.7以上
- 必要なライブラリは `requirements.txt` を参照

<br>

## インストール

1. リポジトリのクローン

```bash
git clone <repository-url>
cd project-portfolio-analyzer
```

2. 仮想環境の作成（推奨）

```bash
python -m venv venv
source venv/bin/activate  # Windowsの場合: venv\Scripts\activate
```

3. 依存パッケージのインストール

```bash
pip install -r requirements.txt
```

<br>

## 使用方法

### 基本的な使い方

```bash
python main.py
```

プログラムを実行すると、以下の対話的プロンプトが表示されます:

1. 既存データがある場合、新規生成するか既存データを使用するか選択
2. データ生成を選択した場合、5業界分のサンプルデータを自動生成
3. ポートフォリオ分析、シグナル分析、類似度分析を順次実行
4. デンドログラム・散布図を `png/` ディレクトリに出力
5. 類似度レポートを `data/` ディレクトリに出力

<br>

### 出力ファイル

実行後、以下のファイルが生成されます:

```
projects/
├── sample_projects_healthcare.csv
├── sample_projects_manufacturing.csv
├── sample_projects_retail.csv
├── sample_projects_technology.csv
└── sample_projects_finance.csv

data/
├── integrated_projects.csv
├── high_similarity_pairs.csv       # 高類似度プロジェクトペア
└── top_similar_projects.csv        # 各プロジェクトの類似TOP5

png/
├── portfolio_dendrogram.png
├── signal_dendrogram.png
└── similarity_scatter_tsne.png     # t-SNE類似度マップ
```

<br>

## 設定ファイル (config.yaml)

`config/config.yaml` で以下の設定をカスタマイズできます:

- **プロジェクトカテゴリー**: IT Infrastructure、Digital Transformation、Process Improvementなど
- **業界修正値**: 各業界のROI倍率、リスク修正値
- **部門リスト**: IT、Marketing、Operationsなど
- **シグナル項目**: 技術スタック、ベンダー、スキルセットなどの選択肢
- **複雑度計算**: 重み付けと閾値の設定
- **生成パラメータ**: プロジェクト数、日付範囲、ランダムシード

<br>

## データ構造

### 生成されるプロジェクトデータの主な属性

**基本属性**:
- `project_id`: ユニークなプロジェクトID（ハッシュベース）
- `project_name`: プロジェクト名
- `category`: プロジェクトカテゴリー
- `start_date`: 開始日
- `department`: 担当部門

**ポートフォリオ属性（数値）**:
- `strategic_alignment`: 戦略的整合性 (1-5)
- `risk`: リスク (1-5)
- `urgency`: 緊急度 (1-5)
- `importance`: 重要度 (1-5)
- `budget`: 予算（百万円）
- `duration`: 期間（月）
- `roi`: 投資対効果（%）
- `stakeholders`: ステークホルダー数
- `complexity`: 複雑度 (High/Medium/Low)

**シグナル属性（カテゴリカル）**:
- `system_database_access`: システム・DB接続
- `technology_stack`: 技術スタック
- `middleware_library`: ミドルウェア/ライブラリ
- `vendor_partner`: ベンダー・パートナー
- `skill_set`: 必要スキルセット
- `procurement_contract`: 調達・契約
- `master_data`: マスタデータ
- `end_user`: エンドユーザー
- `launch_timing`: リリースタイミング
- `regulatory_deadline`: 規制期限

<br>

## 分析手法

### ポートフォリオ分析
- **正規化**: 設定ファイルベースの正規化またはStandardScaler
- **距離メトリック**: ユークリッド距離
- **クラスタリング**: Ward法による階層クラスタリング

### シグナル分析
- **エンコーディング**: ワンホットエンコーディング
- **距離メトリック**: Jaccard距離
- **クラスタリング**: Average linkage法による階層クラスタリング

### 類似度分析
- **類似度計算**: Jaccard類似度行列の算出
- **高類似度ペア抽出**: 閾値（デフォルト0.7）以上のプロジェクトペアを特定
- **共通属性分析**: 類似プロジェクト間の共通シグナル属性を自動検出
- **次元削減**: t-SNEによる2次元可視化
- **レポート生成**: 各プロジェクトの類似TOP5を自動抽出

<br>

### 類似度分析の出力

#### 1. 高類似度ペア (`high_similarity_pairs.csv`)

類似度が閾値（デフォルト0.7）以上のプロジェクトペアを抽出します。

| カラム | 説明 |
|--------|------|
| project_1 | プロジェクト1のID |
| project_2 | プロジェクト2のID |
| similarity | 類似度スコア（0.0～1.0） |
| common_attributes_count | 共通属性の数 |
| common_attributes | 共通属性リスト（最大5つ表示） |

**活用例**:
- リソース共有の可能性がある類似プロジェクトの特定
- 重複投資の検出
- ベストプラクティスの横展開候補の発見

#### 2. TOP類似プロジェクト (`top_similar_projects.csv`)

各プロジェクトに対して、最も類似度の高い5つのプロジェクトをランキング形式で出力します。

| カラム | 説明 |
|--------|------|
| project_id | 対象プロジェクトID |
| top_1_similar | 最も類似するプロジェクトID |
| top_1_score | その類似度スコア |
| top_2_similar ～ top_5_similar | 2位～5位の類似プロジェクト |
| top_2_score ～ top_5_score | それぞれの類似度スコア |

**活用例**:
- 新規プロジェクト計画時の参考事例検索
- 類似プロジェクトの成功パターン分析
- リスク評価時の比較対象特定

#### 3. t-SNE散布図 (`similarity_scatter_tsne.png`)

高次元の類似度データを2次元平面に投影し、プロジェクト間の関係を視覚的に表現します。

**散布図の読み方**:
- 各点が1つのプロジェクトを表す
- 近くにある点同士は類似度が高い
- 赤い線は類似度0.7以上のペアを接続
- クラスター（島状の集まり）は類似プロジェクトのグループ

**活用例**:
- ポートフォリオ全体の構造把握
- 孤立プロジェクト（他と似ていない）の識別
- プロジェクト間の依存関係の可視化

<br>

## ライセンス

このプロジェクトは MIT License の下で公開されています。

<br>
<br>
<br>

# APPENDIX

## ポートフォリオ分析の手法

### **正規化**
- **設定ファイルベースの正規化**: 各属性を0-1の範囲にスケーリングします。例えば、予算は最大値で割り、1-5スケールの属性は(値-1)/4で変換します。これにより異なる単位・スケールの属性を公平に比較できます。
- **StandardScaler**: 各属性を平均0、標準偏差1に変換する標準化手法です。外れ値の影響を受けやすいですが、正規分布に近いデータに効果的です。

### **ユークリッド距離**
2点間の直線距離を計算する最も基本的な距離メトリックです。数値データの類似度測定に広く使用されます。例えば2次元空間での距離は √((x₂-x₁)² + (y₂-y₁)²) で計算されます。予算、期間、リスクなどの数値属性の違いを総合的に評価するのに適しています。

### **Ward法**
クラスター内の分散が最小になるようにグループを結合していく手法です。比較的均等なサイズのクラスターを形成する傾向があり、解釈しやすいデンドログラムを生成します。ポートフォリオ分析では、似た特性を持つプロジェクトを効果的にグループ化できます。

<br>

## シグナル分析の手法

### **ワンホットエンコーディング**
カテゴリカルデータ（文字列）を数値に変換する手法です。例えば「技術スタック」に「AWS」「Azure」「GCP」という3つの選択肢がある場合、各プロジェクトを[1,0,0]、[0,1,0]、[0,0,1]のようなバイナリベクトルで表現します。これにより機械学習アルゴリズムで処理可能になります。

### **Jaccard距離**
集合の類似度を測定する距離メトリックです。2つの集合の共通要素数を全要素数で割った「Jaccard係数」の逆数的な概念です。計算式は 1 - (共通要素数 / 全要素数) です。バイナリデータやカテゴリカルデータの比較に特に有効で、「どれだけ共通の技術・リソースを使っているか」を評価できます。

### **Average linkage法（平均連結法）**
2つのクラスター間のすべてのペアの平均距離を基準にクラスターを結合する手法です。Ward法より外れ値の影響を受けにくく、カテゴリカルデータの分析に適しています。シグナル分析では、似た技術スタックやベンダーを使用するプロジェクトを安定的にグループ化できます。

<br>

## 類似度分析の手法

### **Jaccard類似度行列**
すべてのプロジェクトペア間の類似度を計算した行列です。n個のプロジェクトに対してn×nの対称行列を生成します。対角成分は1.0（自分自身との類似度）、それ以外は0.0～1.0の範囲になります。

### **t-SNE（t-Distributed Stochastic Neighbor Embedding）**
高次元データを2次元または3次元に圧縮する次元削減手法です。データ点間の距離関係を保ちながら低次元空間に投影するため、類似したプロジェクト同士が近くに配置されます。

**特徴**:
- 局所的な構造（近傍関係）を重視
- 非線形な次元削減が可能
- 視覚的に解釈しやすいマップを生成

**注意点**:
- 実行ごとに結果が異なる（random_stateで固定可能）
- 計算コストが高い（大規模データでは時間がかかる）
- 距離の絶対値よりも相対的な位置関係が重要

### **共通属性分析**
ワンホットエンコーディングされたベクトルを比較し、両方のプロジェクトで1（該当）となっている属性を抽出します。これにより「どの技術スタック、ベンダー、スキルセットが共通しているか」が具体的にわかります。

<br>

## なぜ3つの分析で異なる手法を使うのか？

**ポートフォリオ分析**は予算や期間などの**連続的な数値データ**を扱うため、ユークリッド距離とWard法の組み合わせが適しています。

**シグナル分析**は技術スタックやベンダーなどの**離散的なカテゴリデータ**を扱うため、Jaccard距離とAverage linkage法がより適切です。

**類似度分析**は**個別のプロジェクトペア**に焦点を当て、類似度の定量化と視覚化を行います。t-SNEによる2次元投影で、ポートフォリオ全体の構造を直感的に把握できます。

この3つの分析を組み合わせることで、数値面・カテゴリ面・関係性の3つの視点からプロジェクトポートフォリオを多角的に理解できます。

<br>

## 実践的な活用シーン

### シーン1: 新規プロジェクトの立案
1. 類似度分析で過去の類似プロジェクトTOP5を抽出
2. それらのポートフォリオ属性（予算、期間、ROI）を参考に計画を策定
3. t-SNE散布図で全体の中での位置づけを確認

### シーン2: リソース最適化
1. 高類似度ペアから共通技術スタックを特定
2. 複数プロジェクトで共通利用できるベンダー・スキルを見つける
3. リソースの集約と効率化を実現

### シーン3: リスク管理
1. 孤立プロジェクト（類似度が低い）を散布図から発見
2. 独自技術を使うハイリスクプロジェクトとして重点管理
3. 類似プロジェクトの過去トラブル事例を参考にリスク対策

### シーン4: ナレッジ共有
1. TOP類似プロジェクトリストから横展開候補を抽出
2. 成功事例のベストプラクティスを類似プロジェクトに適用
3. 組織全体のプロジェクト品質向上
# サンプルデータ生成ツール

YAMLファイルでデータ定義を読み込み、需要データ（案件データ）または供給データ（社員データ）のサンプルデータをCSV形式で出力するツールです。

## 必要要件

- Python 3.8以上

## セットアップ

### 0. 仮想環境の作成（推奨）
```bash
# 仮想環境を作成
python3 -m venv venv

# 仮想環境を有効化（macOS/Linux）
source venv/bin/activate

# 仮想環境を有効化（Windows）
venv\Scripts\activate
```

### 1. 依存ライブラリのインストール

```bash
pip install -r requirements.txt
```

## 使い方

### 基本的な使い方

プログラムを実行すると、需要データまたは供給データの選択画面が表示されます。

```bash
python main.py
```

実行すると以下のような選択画面が表示されます：

```
============================================================
サンプルデータ生成ツール
============================================================

生成するデータタイプを選択してください:
  1: 需要データ（案件データ）
  2: 供給データ（社員データ）

選択してください (1 または 2): 
```

### 需要データ（案件データ）の生成

`1` を選択すると、`config/data_definition_demand.yaml` の設定に基づいて案件データが生成されます。

### 供給データ（社員データ）の生成

`2` を選択すると、`config/data_definition_supply.yaml` の設定に基づいて社員データが生成されます。

## データ定義ファイル（YAML）

### 需要データの設定（data_definition_demand.yaml）

#### フィールド定義

```yaml
fields:
  - 案件ID
  - 案件名
  - 活動開始月
  - 活動終了月
  - 初期投資金額
  - 運用費
  - システム利用開始時期
```

#### 出力設定

```yaml
output:
  file: demand_data.csv  # 出力ファイル名（csvフォルダ内に出力されます）
  records: 100           # 生成するレコード数
```

#### 詳細設定（オプション）

```yaml
settings:
  # 案件ID形式の設定
  project_id_format:
    prefix: PRJ          # IDのプレフィックス
    digits: 4            # 桁数（ゼロパディング）
  
  # 案件名生成の設定
  project_naming:
    prefixes:
      - 次世代
      - 新規
      - 既存
      - 統合
      - クラウド
      - AI活用
      - DX推進
    systems:
      - 販売管理システム
      - 在庫管理システム
      - 顧客管理システム
      - 会計システム
      - 人事システム
      - ECサイト
      - 基幹システム
    actions:
      - 構築
      - 刷新
      - 移行
      - 導入
      - 開発
  
  # 初期投資金額の範囲（単位：千円）
  initial_investment:
    min: 10000           # 最小値：1000万円
    max: 100000          # 最大値：10億円
  
  # 運用費の割合（初期投資金額に対する比率）
  operation_cost_ratio:
    min: 0.05            # 最小：5%
    max: 0.20            # 最大：20%
  
  # システム利用開始時期の範囲
  start_date:
    from_days_ago: 365   # 過去1年前から
    to_days_ahead: 730   # 未来2年後まで
  
  # 活動期間の設定
  activity_period:
    start_from_days_ago: 730    # 活動開始：過去2年前から
    start_to_days_ahead: 365    # 活動開始：未来1年後まで
    duration_min_months: 3      # 活動期間の最小月数
    duration_max_months: 24     # 活動期間の最大月数
  
  # 日付フォーマット
  date_format: "%Y/%m/%d"
  
  # 月フォーマット
  month_format: "%Y/%m"
  
  # 金額の丸め設定
  rounding:
    thresholds:
      - max: 1000        # 1000未満
        unit: 50         # 50単位で丸める
      - max: 10000       # 10000未満
        unit: 100        # 100単位で丸める
      - max: .inf        # それ以上
        unit: 1000       # 1000単位で丸める
```

### 供給データの設定（data_definition_supply.yaml）

#### フィールド定義

```yaml
fields:
  - 社員ID
  - 稼働開始月
  - 稼働終了月
  - ビジネスケイパビリティ
  - デリバリケイパビリティ
  - テクニカルケイパビリティ
  - リーダーシップケイパビリティ
```

#### 出力設定

```yaml
output:
  file: supply_data.csv  # 出力ファイル名（csvフォルダ内に出力されます）
  records: 50            # 生成するレコード数
```

#### 詳細設定（オプション）

```yaml
settings:
  # 社員ID形式の設定
  employee_id_format:
    prefix: EMP          # IDのプレフィックス
    digits: 5            # 桁数（ゼロパディング）
  
  # 稼働開始月の範囲設定
  work_start_period:
    from_days_ago: 1825  # 過去5年前から（既存社員）
    to_days_ahead: 365   # 未来1年後まで（入社予定者）
  
  # 稼働終了月の設定
  work_end_period:
    probability: 0.2     # 20%の確率で稼働終了月を設定
    min_months_after_start: 6   # 稼働開始から最低6ヶ月後
    max_months_after_start: 60  # 稼働開始から最大60ヶ月後
  
  # ケイパビリティの設定（0.00〜1.00の範囲）
  capability:
    min: 0.00            # 最小値
    max: 1.00            # 最大値
    decimal_places: 2    # 小数点以下の桁数
    
    # ケイパビリティの相関設定
    correlation:
      enabled: true      # 相関を考慮するか
      base_variance: 0.3 # 基準値からの変動幅
  
  # 月フォーマット
  month_format: "%Y/%m"
```

## 生成されるデータの仕様

### 需要データ（案件データ）

| フィールド | 説明 | 例 |
|----------|------|-----|
| 案件ID | PRJ + 4桁連番 | PRJ0001, PRJ0002, ... |
| 案件名 | ランダム生成されるプロジェクト名 | 次世代販売管理システム構築プロジェクト |
| 活動開始月 | プロジェクトの活動開始月 | 2024/01 |
| 活動終了月 | プロジェクトの活動終了月 | 2025/12 |
| 初期投資金額 | 1,000万円〜10億円の範囲（単位：千円） | 15000 (1,500万円) |
| 運用費 | 初期投資金額の5〜20%（単位：千円） | 2250 (225万円) |
| システム利用開始時期 | システムの稼働開始日 | 2025/03/15 |

### 供給データ（社員データ）

| フィールド | 説明 | 例 |
|----------|------|-----|
| 社員ID | EMP + 5桁連番 | EMP00001, EMP00002, ... |
| 稼働開始月 | 社員の稼働開始月（入社月） | 2023/04 |
| 稼働終了月 | 社員の稼働終了月（退職予定月、20%の確率で設定） | 2025/12 または 空欄 |
| ビジネスケイパビリティ | ビジネススキルの評価値（0.00〜1.00） | 0.75 |
| デリバリケイパビリティ | デリバリースキルの評価値（0.00〜1.00） | 0.82 |
| テクニカルケイパビリティ | 技術スキルの評価値（0.00〜1.00） | 0.68 |
| リーダーシップケイパビリティ | リーダーシップの評価値（0.00〜1.00） | 0.71 |

**注意**: ケイパビリティ値は相関を考慮して生成されます。つまり、各社員の4つのケイパビリティ値は全体的なスキルレベルを基準として、ある程度相関を持って生成されます。

## 出力例

### 需要データ（demand_data.csv）

```csv
案件ID,案件名,活動開始月,活動終了月,初期投資金額,運用費,システム利用開始時期
PRJ0001,次世代販売管理システム構築プロジェクト,2024/01,2025/12,15000,2250,2025/03/15
PRJ0002,DX推進会計システム導入プロジェクト,2023/06,2024/08,8500,1020,2024/11/20
PRJ0003,クラウドECサイト開発プロジェクト,2024/09,2025/06,32000,5120,2026/06/10
```

### 供給データ（supply_data.csv）

```csv
社員ID,稼働開始月,稼働終了月,ビジネスケイパビリティ,デリバリケイパビリティ,テクニカルケイパビリティ,リーダーシップケイパビリティ
EMP00001,2023/04,,0.75,0.82,0.68,0.71
EMP00002,2022/10,2025/12,0.45,0.52,0.38,0.48
EMP00003,2024/01,,0.88,0.91,0.85,0.89
```

## ファイル構成

```
.
├── main.py                          # メインエントリポイント
├── modules/                         # モジュールフォルダ
│   ├── demand_data_generator.py    # 需要データ生成モジュール
│   └── supply_data_generator.py    # 供給データ生成モジュール
├── config/                          # 設定ファイルフォルダ
│   ├── data_definition_demand.yaml # 需要データ設定
│   └── data_definition_supply.yaml # 供給データ設定
├── csv/                             # 出力フォルダ（自動生成）
│   ├── demand_data.csv             # 需要データ出力ファイル
│   └── supply_data.csv             # 供給データ出力ファイル
├── requirements.txt                 # 必要なライブラリ
└── README.md                        # このファイル
```

## カスタマイズ

### 出力件数やファイル名の変更

YAMLファイルの `output` セクションを編集してください。

```yaml
output:
  file: custom_output.csv  # 出力ファイル名を変更
  records: 500            # 500件生成に変更
```

### データ生成ロジックのカスタマイズ

より高度なカスタマイズが必要な場合は、各生成モジュールのメソッドを修正してください：

#### 需要データ（demand_data_generator.py）
- `_generate_project_name()`: 案件名の生成ロジック
- `_generate_initial_investment()`: 初期投資金額の範囲と丸め処理
- `_generate_operation_cost()`: 運用費の計算方法
- `_generate_start_date()`: システム利用開始時期の範囲
- `_generate_activity_period()`: 活動期間の生成ロジック

#### 供給データ（supply_data_generator.py）
- `_generate_work_start_month()`: 稼働開始月の生成ロジック
- `_generate_work_end_month()`: 稼働終了月の生成ロジック
- `_generate_correlated_capabilities()`: ケイパビリティ値の生成と相関設定


# IT人材需要計算プログラム

## 概要

このプログラムは、プロジェクトポートフォリオデータから**IT人材のスキル需要**を計算するツールです。

事業会社のIT組織における4つのケイパビリティ（能力）別に、プロジェクト規模・種別・技術領域を考慮した人材需要を算出します。

### 計算される4つのケイパビリティ

1. **ビジネスケイパビリティ** - ビジネス価値創出とステークホルダー連携
2. **デリバリケイパビリティ** - プロジェクト遂行・納品能力
3. **テクニカルケイパビリティ** - 技術的専門性・実装力
4. **リーダーシップケイパビリティ** - 組織・人材マネジメント

---

## 主な機能

- **2段階処理**によるスキル需要計算
  - **ステップ1**: プロジェクト分類処理（中間ファイル生成）
  - **ステップ2**: スキル需要計算（最終結果生成）
  
- **自動分類機能**
  - 投資金額からプロジェクト規模を推定（大規模/中規模/小規模/極小規模）
  - プロジェクト名から技術領域を判定（AI/ML、クラウド、DX/デジタル、従来型）
  - プロジェクト名からプロジェクト種別を判定（新規開発、導入、刷新、移行、その他）
  
- **柔軟なスキル構成比設定**
  - プロジェクト規模とプロジェクト種別の組み合わせごとに異なるスキル構成比を適用
  - YAML設定ファイルで簡単にカスタマイズ可能

- **運用需要の計算**
  - 運用費から年間運用人月を計算
  - 月平均運用人員を算出

---

## システム要件

### 必須環境

- **Python**: 3.7以上
- **必須ライブラリ**:
  - pandas
  - PyYAML

### インストール方法

```bash
pip install pandas pyyaml
```

---

## ディレクトリ構成

```
project_root/
├── main.py                          # メインプログラム
├── config/
│   └── calc_assumptions.yaml        # 設定ファイル
├── modules/
│   └── demand_calculator.py         # 需要計算クラス
├── CSV/                             # 入力CSVファイル格納フォルダ
│   └── *.csv                        # プロジェクトポートフォリオCSV
├── intermediate/                    # 中間ファイル格納フォルダ
│   └── classified_*.csv             # 分類結果CSV（自動生成）
└── out/                             # 最終出力ファイル格納フォルダ
    └── *.csv                        # スキル需要計算結果CSV（自動生成）
```

---

## 入力CSVフォーマット

### 必須列

入力CSVファイルには以下の列が必要です:

| 列名 | データ型 | 説明 | 例 |
|------|---------|------|-----|
| `案件ID` | 文字列 | プロジェクトの一意識別子 | `PRJ-001` |
| `案件名` | 文字列 | プロジェクト名（分類判定に使用） | `AI活用による需要予測システム開発` |
| `活動開始月` | 日付 | プロジェクト活動開始月 | `2024-10-01` |
| `活動終了月` | 日付 | プロジェクト活動終了月 | `2025-03-31` |
| `初期投資金額` | 数値 | 初期投資額（千円単位） | `120000` |
| `運用費` | 数値 | 年間運用費（千円単位） | `24000` |
| `システム利用開始時期` | 日付 | システム稼働開始日 | `2025-04-01` |

> **注**: `活動開始月`と`活動終了月`が両方存在する場合、活動期間月数が計算されます。存在しない場合はデフォルト12ヶ月として扱われます。

---
<br>

## 出力CSVフォーマット

### 中間ファイル（intermediate/classified_*.csv）

プロジェクトの分類情報が追加されます:

| 列名 | 説明 |
|------|------|
| 元のデータ列 | 入力CSVのすべての列 |
| `稼働開始日` | システム利用開始時期（日付型） |
| `稼働年度` | 稼働開始年度 |
| `活動期間月数` | 活動期間（月） |
| `プロジェクト規模` | 大規模/中規模/小規模/極小規模 |
| `プロジェクト種別` | 新規開発、導入、刷新、移行、その他 |
| `推定人月` | 投資金額から推定された総人月数 |

### 最終出力ファイル（out/*.csv）

スキル需要の計算結果が追加されます:

| 列名 | 説明 |
|------|------|
| `ビジネスケイパビリティ` | ビジネスケイパビリティの月平均人員（人月） |
| `デリバリケイパビリティ` | デリバリケイパビリティの月平均人員（人月） |
| `テクニカルケイパビリティ` | テクニカルケイパビリティの月平均人員（人月） |
| `リーダーシップケイパビリティ` | リーダーシップケイパビリティの月平均人員（人月） |
| `運用_年間人月` | 年間運用人月 |
| `運用_月平均` | 月平均運用人員（人月） |

---
<br>

## 使用方法

### 1. 入力ファイルの準備

`CSV/`フォルダにプロジェクトポートフォリオのCSVファイルを配置します。

```bash
CSV/
├── project_portfolio_2024.csv
└── project_portfolio_2025.csv
```

### 2. プログラムの実行

```bash
python3 main.py
```

実行すると、ステップ選択画面が表示されます:

```
実行するステップを選択してください:
  1: ステップ1のみ（分類処理）
  2: ステップ2のみ（需要計算）
  Enter: 両方実行（デフォルト）

選択 [Enter]: 
```

#### 実行モードの選択

- **Enter（デフォルト）**: ステップ1→2を連続実行（通常の使い方）
- **1を入力**: ステップ1のみ実行（分類処理）
  - 用途: 分類精度の確認、YAML設定の微調整
  - 中間ファイルを確認してから次のステップを決定
- **2を入力**: ステップ2のみ実行（需要計算）
  - 用途: 中間ファイルを手動修正した後の再計算
  - intermediateフォルダのCSVを編集してから実行

### 3. 処理の流れ

プログラムは以下の2段階で処理を実行します:

#### ステップ1: プロジェクト分類処理

- CSV/フォルダ内の全CSVファイルを読み込み
- 各プロジェクトを分類（規模、技術領域、種別）
- 分類結果を`intermediate/classified_*.csv`に保存

**ステップ1のみ実行した場合の活用例:**

1. 中間ファイル（intermediate/classified_*.csv）を開いて分類結果を確認
2. 分類精度が低い場合は`calc_assumptions.yaml`のキーワードや閾値を調整
3. 再度ステップ1を実行して分類精度を向上
4. 満足できる分類結果が得られたらステップ2へ進む

#### ステップ2: スキル需要計算

- 中間ファイルを読み込み
- スキル構成比を適用して需要を計算
- 最終結果を`out/*.csv`に保存

**ステップ2のみ実行した場合の活用例:**

1. ステップ1で生成された中間ファイルをExcelなどで開く
2. 機械分類の結果を人手で修正（例: 規模や種別の手動変更）
3. 修正したCSVを保存
4. ステップ2のみを実行して、修正後の分類結果から需要を計算

### 4. 結果の確認

- **中間ファイル**: `intermediate/`フォルダで分類結果を確認
- **最終結果**: `out/`フォルダでスキル需要計算結果を確認

---
<br>

## 計算ロジック

### 1. プロジェクト規模の推定

投資金額から総人月を計算し、規模を判定します:

```
外注費ベース人月 = (初期投資金額 × 人件費比率) ÷ 平均単価
総人月 = 外注費ベース人月 ÷ (1 - 内製比率)
```

**デフォルトパラメータ**（config.yaml で変更可能）:
- 人件費比率: 60%
- 平均単価: 2,000千円/人月
- 内製比率: 30%

**規模判定基準**:
- **大規模**: 150人月以上
- **中規模**: 50人月以上150人月未満
- **小規模**: 20人月以上50人月未満
- **極小規模**: 20人月未満

### 2. 技術領域の判定

プロジェクト名に含まれるキーワードで判定します:

| 技術領域 | キーワード |
|---------|----------|
| AI/ML | AI活用、機械学習、人工知能 |
| クラウド | クラウド、AWS、Azure、GCP |
| DX/デジタル | DX推進、デジタル、デジタル化 |
| 従来型 | 上記以外のすべて |

### 3. プロジェクト種別の判定

プロジェクト名に含まれるキーワードで判定します:

| プロジェクト種別 | キーワード | 説明 |
|---------------|----------|------|
| 新規開発 | 開発、構築 | 構想・PoC・プロトタイプ開発 |
| 導入 | 導入 | 要件定義～本番導入 |
| 刷新 | 刷新、リプレース | 既存システムの更改 |
| 移行 | 移行 | システム移行・データ移行 |
| その他 | 上記以外 | その他のプロジェクト |

### 4. スキル需要の計算

プロジェクト規模とプロジェクト種別の組み合わせに応じたスキル構成比を適用します:

```
各ケイパビリティの月平均人員 = (推定人月 ÷ 活動期間月数) × スキル構成比
```

**スキル構成比の例** (大規模 × 新規開発):
- ビジネスケイパビリティ: 35%
- デリバリケイパビリティ: 20%
- テクニカルケイパビリティ: 30%
- リーダーシップケイパビリティ: 15%

### 5. 運用需要の計算

```
年間運用人月 = (運用費 × 人件費比率) ÷ 平均単価
月平均運用人員 = 年間運用人月 ÷ 12
```

**デフォルトパラメータ**（config.yaml で変更可能）:
- 人件費比率: 60%
- 平均単価: 1,000千円/人月

---
<br>

## 設定ファイル（config.yaml）

設定ファイルで以下のパラメータをカスタマイズできます:

### 1. プロジェクト規模の判定基準

```yaml
project_size_thresholds:
  large:
    min_person_months: 150    # 150人月以上
  medium:
    min_person_months: 50     # 50人月以上
  small:
    min_person_months: 20     # 20人月以上
  extra_small:
    min_person_months: 0      # 20人月未満
```

### 2. 技術領域の判定キーワード

```yaml
tech_area_keywords:
  "AI/ML":
    - "AI活用"
    - "機械学習"
    - "人工知能"
  "クラウド":
    - "クラウド"
    - "AWS"
    - "Azure"
    - "GCP"
  # ...
```

### 3. プロジェクト種別の判定キーワード

```yaml
project_type_keywords:
  "移行":
    - "移行"
  "刷新":
    - "刷新"
    - "リプレース"
  # ...
```

### 4. スキル構成比

プロジェクト規模×種別ごとに定義:

```yaml
skill_distribution:
  large_新規開発:
    "ビジネスケイパビリティ": 0.35
    "デリバリケイパビリティ": 0.20
    "テクニカルケイパビリティ": 0.30
    "リーダーシップケイパビリティ": 0.15
  # ...
```

### 5. 投資金額から人月を推定するパラメータ

```yaml
investment_to_person_months:
  labor_cost_ratio: 0.60   # 初期投資のうち人件費が占める比率
  average_unit_cost: 2000  # 平均単価（千円/人月）
  in_house_ratio: 0.3      # 内製比率
```

### 6. 運用需要の計算パラメータ

```yaml
operation_parameters:
  labor_cost_ratio: 0.60  # 運用費のうち人件費が占める比率
  average_unit_cost: 1000 # 平均単価（千円/人月）
```

---

## 実行例

### コンソール出力

```
================================================================================
IT人材需要計算プログラム v2.0
================================================================================

実行するステップを選択してください:
  1: ステップ1のみ（分類処理）
  2: ステップ2のみ（需要計算）
  Enter: 両方実行（デフォルト）

選択 [Enter]: 

================================================================================
実行モード: 全ステップ実行（分類→需要計算）
================================================================================

中間ファイルフォルダ: intermediate
最終出力フォルダ: out

見つかったCSVファイル: 2件
  - project_portfolio_2024.csv
  - project_portfolio_2025.csv

================================================================================
ステップ1: プロジェクト分類処理を開始します
================================================================================

【ステップ1: プロジェクト分類】
処理中: project_portfolio_2024.csv
------------------------------------------------------------
  ✓ データ読み込み: 45件
  ✓ 中間ファイル出力完了: intermediate/classified_project_portfolio_2024.csv

  【分類サマリー】

  プロジェクト規模別:
    大規模        :  10件
    中規模        :  18件
    小規模        :  12件
    極小規模      :   5件

  技術領域別:
    従来型        :  25件
    AI/ML         :   8件
    クラウド      :   7件
    DX/デジタル   :   5件

  プロジェクト種別:
    新規開発      :  15件
    導入          :  12件
    刷新          :  10件
    移行          :   5件
    その他        :   3件

================================================================================
ステップ1: 分類処理が完了しました
================================================================================

生成された中間ファイル:
  - classified_project_portfolio_2024.csv
  - classified_project_portfolio_2025.csv

================================================================================
ステップ2: スキル需要計算を開始します
================================================================================

処理する中間ファイル: 2件
  - classified_project_portfolio_2024.csv
  - classified_project_portfolio_2025.csv

【ステップ2: スキル需要計算】
処理中: classified_project_portfolio_2024.csv
------------------------------------------------------------
  ✓ 中間ファイル読み込み: 45件
  ✓ スキル需要計算完了
  ✓ 最終結果出力完了: out/project_portfolio_2024.csv

  【サマリー】

  全体ケイパビリティ別需要（期間中月平均の合計）:
    ビジネスケイパビリティ      :  125.3名
    デリバリケイパビリティ      :  142.7名
    テクニカルケイパビリティ    :  198.5名
    リーダーシップケイパビリティ:   45.2名

================================================================================
ステップ2: スキル需要計算が完了しました
================================================================================

最終出力ファイル:
  - project_portfolio_2024.csv
  - project_portfolio_2025.csv

================================================================================
すべての処理が完了しました
================================================================================

最終結果: /path/to/out
中間ファイル: /path/to/intermediate
```

### ステップ1のみ実行した場合の出力例

```
================================================================================
IT人材需要計算プログラム v2.0
================================================================================

実行するステップを選択してください:
  1: ステップ1のみ（分類処理）
  2: ステップ2のみ（需要計算）
  Enter: 両方実行（デフォルト）

選択 [Enter]: 1

================================================================================
実行モード: ステップ1のみ（分類処理）
================================================================================

中間ファイルフォルダ: intermediate
最終出力フォルダ: out

見つかったCSVファイル: 1件
  - project_portfolio_2024.csv

================================================================================
ステップ1: プロジェクト分類処理を開始します
================================================================================

（分類処理の詳細...）

================================================================================
ステップ1: 分類処理が完了しました
================================================================================

生成された中間ファイル:
  - classified_project_portfolio_2024.csv

================================================================================
処理が完了しました（ステップ1のみ実行）
================================================================================

中間ファイルを確認してください: /path/to/intermediate

次のステップ:
  1. intermediateフォルダ内のCSVファイルで分類結果を確認
  2. 必要に応じてcalc_assumptions.yamlを微調整
  3. 再度ステップ1を実行するか、ステップ2で需要計算を実行
```

---
